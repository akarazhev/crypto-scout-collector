# Issue 4: Create bybit spot tables

In this `crypto-scout-collector-db` project we are going to create the following bybit spot tables to save the data
received from the Bybit websocket: `bybit_spot_kline_15m`, `bybit_spot_kline_60m`, `bybit_spot_kline_240m`,
`bybit_spot_kline_1d`, `bybit_spot_public_trade`, `bybit_spot_order_book_200`. Table schemas must be in normalized form
and optimal to perform analysis and efficient saving the data. Data removal and compression must be done with:
`retention` and `compression` policies.

## Roles

Take the following roles:

- Expert database engineer.
- Expert technical writer.

## Conditions

- Use the best practices and design patterns.
- Use the following technical stack: `timescale/timescaledb:latest-pg17`.
- Use the same data schemas for `kline` data.
- Use human-readable names for parameter names.
- Normalize data schemas for optimal savings and analysts.
- Do not hallucinate.

## Tasks

- As the `expert database engineer` review the current `init.sql` script implementation in `crypto-scout-collector-db`
  project and update it by defining the following tables: `bybit_spot_kline_15m`, `bybit_spot_kline_60m`,
  `bybit_spot_kline_240m`, `bybit_spot_kline_1d`, `bybit_spot_public_trade`, `bybit_spot_order_book_200`.
- As the `expert database engineer` define for tables indexes, retentions and compressions. Table schemas must be in
  normalized form and optimal to perform analysis and efficient saving the data. Data removal and compression must be
  done with: `retention` and `compression` policies.
- As the `expert database engineer` recheck your proposal and make sure that they are correct and haven't missed any
  important points.
- As the `expert database engineer` rely on the definition of the data section.
- As the technical writer update the `README.md` and `collector-production-setup.md` files with your results.
- As the technical writer update the `4-create-bybit-spot-tables.md` file with your resolution.

## Definition of the data

### Bybit spot klines data

The `kline` data received from the Bybit websocket is the following:

```json
{
  "type": "snapshot",
  "topic": "kline.15.ETHUSDT",
  "data": [
    {
      "start": 1761591600000,
      "end": 1761592499999,
      "interval": "15",
      "open": "4951.21",
      "close": "4951.21",
      "high": "4951.21",
      "low": "4951.21",
      "volume": "0",
      "turnover": "0",
      "confirm": false,
      "timestamp": 1761591715966
    }
  ],
  "ts": 1761591715966
}
```

```json
{
  "type": "snapshot",
  "topic": "kline.60.BTCUSDT",
  "data": [
    {
      "start": 1761634800000,
      "end": 1761638399999,
      "interval": "60",
      "open": "115488.04",
      "close": "115116",
      "high": "115488.04",
      "low": "114929.92",
      "volume": "0.435693",
      "turnover": "50076.34804012",
      "confirm": false,
      "timestamp": 1761637002902
    }
  ],
  "ts": 1761637002902
}
```

Parameters to save:

- `ts`: number. The timestamp (ms) that the system generates the data.
- `symbol`: string. Example: `ETHUSDT`.
- `start`: number. The start timestamp (ms).
- `end`: number. The end timestamp (ms).
- `open`: string. Open price.
- `close`: string. Close price.
- `high`: string. Highest price.
- `low`: string. Lowest price.
- `volume`: string. Trade volume.
- `turnover`: string. Turnover.

The `kline` data must be saved in the following tables:

- `bybit_spot_kline_15m` - to save `15m interval` data.
- `bybit_spot_kline_60m` - to save `60m interval` data.
- `bybit_spot_kline_240m` - to save `240m interval` data.
- `bybit_spot_kline_1d` - to save `1d interval` data.

Only confirmed klines must be saved.

### Bybit spot public trade data

The `public trade` data received from the Bybit websocket is the following:

```json
{
  "ts": 1760117214053,
  "data": [
    {
      "i": "2290000000908760214",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.000061",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760215",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.084697",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760216",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.1069",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760217",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.050819",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760218",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.105026",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760219",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.07472",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760220",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.029913",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760221",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.03167",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760222",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.0256",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760223",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.001",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760224",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.000212",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760225",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.000212",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760226",
      "T": 1760117214051,
      "p": "118067.5",
      "v": "0.001",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760227",
      "T": 1760117214051,
      "p": "118066.4",
      "v": "0.01",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760228",
      "T": 1760117214051,
      "p": "118066",
      "v": "0.016938",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760229",
      "T": 1760117214051,
      "p": "118065.9",
      "v": "0.004233",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    },
    {
      "i": "2290000000908760230",
      "T": 1760117214051,
      "p": "118065.5",
      "v": "0.042544",
      "S": "Sell",
      "seq": 87416325577,
      "s": "BTCUSDT",
      "BT": false,
      "RPI": false
    }
  ]
}
```

NOTE: For Futures and Spot, a single message may have up to 1024 trades. As such, multiple messages may be sent for the
same `seq`.

Parameters to save:

- `ts`: number. The timestamp (ms) that the system generates the data
- `data`: array. Object. Sorted by the time the trade was matched in ascending order:
- `i`: string. Trade ID
- `T`: number. The timestamp (ms) that the order is filled
- `p`: string. Trade price
- `v`: string. Trade size
- `S`: string. Side of taker. **Buy**,**Sell**
- `seq`: integer. cross sequence
- `s`: string. Symbol name
- `BT`: boolean. Whether it is a block trade order or not
- `RPI`: boolean. Whether it is a RPI trade or not

The `trade` data must be saved in normalized form in the following table: `bybit_spot_public_trade`.

### Bybit spot order book data

The `order book` data received from the Bybit websocket is the following:

```json
{
  "topic": "orderbook.200.BTCUSDT",
  "ts": 1761592479212,
  "type": "snapshot",
  "data": {
    "s": "BTCUSDT",
    "b": [
      [
        "120790.18",
        "0.185613"
      ],
      [
        "120773",
        "8.1272"
      ],
      [
        "120652",
        "0.001422"
      ],
      [
        "120625",
        "0.000537"
      ],
      [
        "120534.07",
        "0.001201"
      ],
      [
        "120532",
        "0.001904"
      ],
      [
        "120526.2",
        "0.000938"
      ],
      [
        "120511.12",
        "0.691731"
      ],
      [
        "120474.51",
        "0.005298"
      ],
      [
        "120454.54",
        "0.00016"
      ],
      [
        "120426.8",
        "0.000275"
      ],
      [
        "120329.12",
        "0.000599"
      ],
      [
        "120232.06",
        "0.691731"
      ],
      [
        "120000",
        "0.000714"
      ],
      [
        "119999.92",
        "0.000688"
      ],
      [
        "119982.51",
        "0.00018"
      ],
      [
        "119953",
        "0.510051"
      ],
      [
        "119853.13",
        "0.001201"
      ],
      [
        "119818.46",
        "0.005422"
      ],
      [
        "119800",
        "0.000215"
      ],
      [
        "119789.36",
        "0.000938"
      ],
      [
        "119720.5",
        "0.000275"
      ],
      [
        "119716.1",
        "0.000599"
      ],
      [
        "119673.94",
        "0.691731"
      ],
      [
        "119667.3",
        "0.000144"
      ],
      [
        "119600",
        "0.000448"
      ],
      [
        "119599.74",
        "0.000492"
      ],
      [
        "119582.3",
        "0.002"
      ],
      [
        "119547.44",
        "0.000437"
      ],
      [
        "119545.45",
        "0.00016"
      ],
      [
        "119471.04",
        "0.000224"
      ],
      [
        "119447.79",
        "0.000084"
      ],
      [
        "119394.88",
        "0.691731"
      ],
      [
        "119386.31",
        "0.002593"
      ],
      [
        "119375",
        "0.000537"
      ],
      [
        "119291.78",
        "0.000129"
      ],
      [
        "119172.19",
        "0.001151"
      ],
      [
        "119166.63",
        "0.000418"
      ],
      [
        "119166.59",
        "0.000688"
      ],
      [
        "119162.41",
        "0.005298"
      ],
      [
        "119115.82",
        "0.691731"
      ],
      [
        "119103.08",
        "0.000599"
      ],
      [
        "119090.9",
        "0.000153"
      ],
      [
        "119052.52",
        "0.000938"
      ],
      [
        "119014.2",
        "0.000275"
      ],
      [
        "119000",
        "0.000793"
      ],
      [
        "118985.06",
        "0.000182"
      ],
      [
        "118836.76",
        "0.691731"
      ],
      [
        "118834.42",
        "0.00018"
      ],
      [
        "118750",
        "0.000643"
      ],
      [
        "118636.36",
        "0.00016"
      ],
      [
        "118557.7",
        "0.691731"
      ],
      [
        "118530.54",
        "0.000091"
      ],
      [
        "118520.35",
        "0.000144"
      ],
      [
        "118506.36",
        "0.005422"
      ],
      [
        "118500",
        "0.000215"
      ],
      [
        "118491.25",
        "0.001201"
      ],
      [
        "118490.06",
        "0.000599"
      ],
      [
        "118333.3",
        "0.000642"
      ],
      [
        "118333.26",
        "0.000688"
      ],
      [
        "118315.68",
        "0.000938"
      ],
      [
        "118307.9",
        "0.000275"
      ],
      [
        "118278.64",
        "0.691731"
      ],
      [
        "118181.81",
        "0.000153"
      ],
      [
        "118159.22",
        "0.000376"
      ],
      [
        "118125",
        "0.000537"
      ],
      [
        "118068.96",
        "0.000492"
      ],
      [
        "118000",
        "0.01275"
      ],
      [
        "117999.58",
        "0.691731"
      ],
      [
        "117959.15",
        "0.000437"
      ],
      [
        "117957.59",
        "0.007821"
      ],
      [
        "117951.96",
        "0.000224"
      ],
      [
        "117877.04",
        "0.000599"
      ],
      [
        "117850.31",
        "0.005298"
      ],
      [
        "117810.31",
        "0.001201"
      ],
      [
        "117727.27",
        "0.00016"
      ],
      [
        "117720.52",
        "0.691731"
      ],
      [
        "117686.33",
        "0.00018"
      ],
      [
        "117601.6",
        "0.000275"
      ],
      [
        "117578.84",
        "0.000938"
      ],
      [
        "117532.7",
        "0.002593"
      ],
      [
        "117500",
        "0.000752"
      ],
      [
        "117499.97",
        "0.000418"
      ],
      [
        "117499.93",
        "0.000688"
      ],
      [
        "117441.46",
        "0.691731"
      ],
      [
        "117373.4",
        "0.000144"
      ],
      [
        "117332.49",
        "0.000182"
      ],
      [
        "117272.88",
        "0.000129"
      ],
      [
        "117272.72",
        "0.000153"
      ],
      [
        "117264.02",
        "0.000599"
      ],
      [
        "117200",
        "0.000215"
      ],
      [
        "117194.26",
        "0.005422"
      ],
      [
        "117182.59",
        "0.00064"
      ],
      [
        "117162.4",
        "0.691731"
      ],
      [
        "117129.37",
        "0.001201"
      ],
      [
        "117111.22",
        "0.000041"
      ],
      [
        "117000",
        "0.000684"
      ],
      [
        "116924.38",
        "0.000044"
      ],
      [
        "116909",
        "0.000128"
      ],
      [
        "116895.3",
        "0.000275"
      ],
      [
        "116883.34",
        "8.129012"
      ],
      [
        "116875",
        "0.000537"
      ],
      [
        "116847.06",
        "0.000128"
      ],
      [
        "116847.02",
        "0.000091"
      ],
      [
        "116842",
        "0.000938"
      ],
      [
        "116829.49",
        "0.008594"
      ],
      [
        "116818.18",
        "0.00016"
      ],
      [
        "116666.64",
        "0.000642"
      ],
      [
        "116666.6",
        "0.000688"
      ],
      [
        "116651",
        "0.000599"
      ],
      [
        "116618.66",
        "0.000171"
      ],
      [
        "116604.28",
        "61.043004"
      ],
      [
        "116600",
        "0.000907"
      ],
      [
        "116552.36",
        "0.00101"
      ],
      [
        "116538.24",
        "0.002211"
      ],
      [
        "116538.21",
        "0.005298"
      ],
      [
        "116538.18",
        "0.000492"
      ],
      [
        "116471.95",
        "0.015025"
      ],
      [
        "116448.43",
        "0.001201"
      ],
      [
        "116435",
        "0.001"
      ],
      [
        "116432.88",
        "0.000224"
      ],
      [
        "116400",
        "0.000448"
      ],
      [
        "116370.86",
        "0.000437"
      ],
      [
        "116363.63",
        "0.000153"
      ],
      [
        "116335.29",
        "0.00101"
      ],
      [
        "116330",
        "0.0008"
      ],
      [
        "116325.22",
        "0.691731"
      ],
      [
        "116292.29",
        "0.000255"
      ],
      [
        "116266.8",
        "0.0005"
      ],
      [
        "116250",
        "0.000643"
      ],
      [
        "116226.45",
        "0.000144"
      ],
      [
        "116189",
        "0.000275"
      ],
      [
        "116123.43",
        "0.00101"
      ],
      [
        "116105.16",
        "0.000938"
      ],
      [
        "116046.16",
        "0.040247"
      ],
      [
        "116037.98",
        "0.000599"
      ],
      [
        "116000",
        "0.013463"
      ],
      [
        "115918.61",
        "0.00102"
      ],
      [
        "115909.09",
        "0.00016"
      ],
      [
        "115900",
        "0.000215"
      ],
      [
        "115882.16",
        "0.005422"
      ],
      [
        "115833.31",
        "0.000418"
      ],
      [
        "115833.27",
        "0.000688"
      ],
      [
        "115767.49",
        "0.001201"
      ],
      [
        "115767.1",
        "0.691731"
      ],
      [
        "115722.37",
        "0.00102"
      ],
      [
        "115679.92",
        "0.000182"
      ],
      [
        "115679.09",
        "0.002593"
      ],
      [
        "115650.08",
        "0.01297"
      ],
      [
        "115640.64",
        "0.000119"
      ],
      [
        "115625",
        "0.000537"
      ],
      [
        "115536",
        "0.00102"
      ],
      [
        "115488.04",
        "0.691731"
      ],
      [
        "115482.7",
        "0.000275"
      ],
      [
        "115454.54",
        "0.000153"
      ],
      [
        "115424.96",
        "0.000599"
      ],
      [
        "115390.15",
        "0.00018"
      ],
      [
        "115368.32",
        "0.000922"
      ],
      [
        "115360.45",
        "0.00102"
      ],
      [
        "115253.98",
        "0.000129"
      ],
      [
        "115229.36",
        "0.000376"
      ],
      [
        "115226.11",
        "0.004945"
      ],
      [
        "115208.98",
        "0.597912"
      ],
      [
        "115196.38",
        "0.00102"
      ],
      [
        "115163.5",
        "0.000091"
      ],
      [
        "115120.75",
        "0.007821"
      ],
      [
        "115086.55",
        "0.001201"
      ],
      [
        "115079.5",
        "0.000144"
      ],
      [
        "115044.16",
        "0.00102"
      ],
      [
        "115007.4",
        "0.000492"
      ],
      [
        "115000",
        "0.002722"
      ],
      [
        "114999.98",
        "0.000642"
      ],
      [
        "114999.94",
        "0.000688"
      ],
      [
        "114929.92",
        "0.691731"
      ],
      [
        "114913.8",
        "0.000224"
      ],
      [
        "114811.94",
        "0.000599"
      ],
      [
        "114800",
        "0.000448"
      ],
      [
        "114782.57",
        "0.000437"
      ],
      [
        "114776.4",
        "0.000275"
      ],
      [
        "114711.31",
        "0.00084"
      ],
      [
        "114697.02",
        "0.00089"
      ],
      [
        "114650.86",
        "0.691731"
      ],
      [
        "114631.48",
        "0.000938"
      ],
      [
        "114600",
        "0.000215"
      ],
      [
        "114570.06",
        "0.005422"
      ],
      [
        "114567.87",
        "0.00103"
      ],
      [
        "114545.45",
        "0.000153"
      ],
      [
        "114521.81",
        "0.00077"
      ],
      [
        "114500",
        "0.000109"
      ],
      [
        "114475.96",
        "0.008735"
      ],
      [
        "114445.37",
        "0.00094"
      ],
      [
        "114438.26",
        "0.00064"
      ],
      [
        "114405.61",
        "0.001201"
      ],
      [
        "114375",
        "0.000537"
      ],
      [
        "114373.56",
        "0.00098"
      ],
      [
        "114371.8",
        "0.691731"
      ],
      [
        "114286.65",
        "0.000554"
      ],
      [
        "114285.22",
        "0.0009"
      ],
      [
        "114265.48",
        "0.00079"
      ],
      [
        "114242.06",
        "0.00018"
      ]
    ],
    "a": [
      [
        "121257",
        "0.000998"
      ],
      [
        "121348.3",
        "0.691039"
      ],
      [
        "121378",
        "0.00148"
      ],
      [
        "121499",
        "0.001962"
      ],
      [
        "121555.16",
        "0.000597"
      ],
      [
        "121607",
        "0.159"
      ],
      [
        "121627.36",
        "0.691039"
      ],
      [
        "121666.58",
        "0.000687"
      ],
      [
        "121677.8",
        "0.000155"
      ],
      [
        "121786.61",
        "0.005606"
      ],
      [
        "121839.4",
        "0.000304"
      ],
      [
        "121860.88",
        "0.000082"
      ],
      [
        "121891.84",
        "0.000051"
      ],
      [
        "121895.95",
        "0.0012"
      ],
      [
        "121897.58",
        "0.000098"
      ],
      [
        "121906.42",
        "0.691039"
      ],
      [
        "121961.2",
        "0.000143"
      ],
      [
        "121999.88",
        "0.000937"
      ],
      [
        "122000",
        "0.000176"
      ],
      [
        "122107.7",
        "0.004094"
      ],
      [
        "122185.48",
        "0.691039"
      ],
      [
        "122272.72",
        "0.000159"
      ],
      [
        "122278.69",
        "0.000188"
      ],
      [
        "122279.93",
        "0.001498"
      ],
      [
        "122290.2",
        "0.000181"
      ],
      [
        "122334.22",
        "0.00325"
      ],
      [
        "122368.52",
        "0.000049"
      ],
      [
        "122400",
        "0.000214"
      ],
      [
        "122442.66",
        "0.005734"
      ],
      [
        "122464.54",
        "0.691039"
      ],
      [
        "122499.91",
        "0.000687"
      ],
      [
        "122545.7",
        "0.000304"
      ],
      [
        "122576.89",
        "0.0012"
      ],
      [
        "122661.3",
        "0.000506"
      ],
      [
        "122671.25",
        "0.00063"
      ],
      [
        "122724.02",
        "0.000436"
      ],
      [
        "122736.72",
        "0.000937"
      ],
      [
        "122743.6",
        "0.691039"
      ],
      [
        "122800",
        "0.000477"
      ],
      [
        "122995.79",
        "0.000531"
      ],
      [
        "123000",
        "0.000176"
      ],
      [
        "123022.66",
        "0.691039"
      ],
      [
        "123093.53",
        "0.00259"
      ],
      [
        "123098.71",
        "0.005606"
      ],
      [
        "123108.15",
        "0.000143"
      ],
      [
        "123126.25",
        "0.00059"
      ],
      [
        "123181.81",
        "0.000159"
      ],
      [
        "123206",
        "0.001"
      ],
      [
        "123252",
        "0.000304"
      ],
      [
        "123257.83",
        "0.0012"
      ],
      [
        "123301.72",
        "0.691039"
      ],
      [
        "123329.58",
        "0.000128"
      ],
      [
        "123333.24",
        "0.000687"
      ],
      [
        "123391.56",
        "1.988163"
      ],
      [
        "123426.78",
        "0.002297"
      ],
      [
        "123473.56",
        "0.000937"
      ],
      [
        "123580.78",
        "0.691039"
      ],
      [
        "123581.1",
        "0.000098"
      ],
      [
        "123581.16",
        "0.000131"
      ],
      [
        "123631.27",
        "0.007817"
      ],
      [
        "123700",
        "0.000214"
      ],
      [
        "123724.38",
        "0.000043"
      ],
      [
        "123754.76",
        "0.005734"
      ],
      [
        "123859.84",
        "0.057887"
      ],
      [
        "123938.77",
        "0.0012"
      ],
      [
        "123942.77",
        "0.000181"
      ],
      [
        "123958.3",
        "0.000304"
      ],
      [
        "124000",
        "0.001422"
      ],
      [
        "124018.94",
        "0.000375"
      ],
      [
        "124090.9",
        "0.000159"
      ],
      [
        "124138.9",
        "0.568606"
      ],
      [
        "124150",
        "0.000137"
      ],
      [
        "124166.57",
        "0.000687"
      ],
      [
        "124192.08",
        "0.000506"
      ],
      [
        "124210.4",
        "0.000937"
      ],
      [
        "124255.1",
        "0.000143"
      ],
      [
        "124312.31",
        "0.000436"
      ],
      [
        "124317.35",
        "0.000097"
      ],
      [
        "124400",
        "0.000477"
      ],
      [
        "124410.81",
        "0.005606"
      ],
      [
        "124417.96",
        "0.691039"
      ],
      [
        "124455.92",
        "0.002008"
      ],
      [
        "124572.7",
        "0.008866"
      ],
      [
        "124574.87",
        "0.000188"
      ],
      [
        "124619.71",
        "0.0012"
      ],
      [
        "124664.6",
        "0.000304"
      ],
      [
        "124697.02",
        "0.52335"
      ],
      [
        "124921.25",
        "0.000088"
      ],
      [
        "124947.14",
        "0.00259"
      ],
      [
        "124947.23",
        "0.000253"
      ],
      [
        "124947.24",
        "0.000937"
      ],
      [
        "124958.75",
        "0.00078"
      ],
      [
        "124976.08",
        "0.691039"
      ],
      [
        "124979.06",
        "0.00084"
      ],
      [
        "124999.9",
        "0.000687"
      ],
      [
        "124999.99",
        "0.000159"
      ],
      [
        "125000",
        "3.24757"
      ],
      [
        "125066.86",
        "0.005734"
      ],
      [
        "125166.14",
        "0.000687"
      ],
      [
        "125196.94",
        "0.000028"
      ],
      [
        "125240.11",
        "0.000048"
      ],
      [
        "125255.14",
        "0.691039"
      ],
      [
        "125264.62",
        "0.000098"
      ],
      [
        "125272.16",
        "0.0007"
      ],
      [
        "125295.85",
        "0.00078"
      ],
      [
        "125300.65",
        "0.0012"
      ],
      [
        "125348.48",
        "0.000128"
      ],
      [
        "125368.06",
        "0.00088"
      ],
      [
        "125370.9",
        "0.000304"
      ],
      [
        "125402.05",
        "0.000143"
      ],
      [
        "125415.58",
        "0.00063"
      ],
      [
        "125515.08",
        "0.00094"
      ],
      [
        "125534.2",
        "0.691039"
      ],
      [
        "125595.34",
        "0.000181"
      ],
      [
        "125601.31",
        "0.000551"
      ],
      [
        "125684.08",
        "0.000937"
      ],
      [
        "125707.25",
        "0.001838"
      ],
      [
        "125722.86",
        "0.000506"
      ],
      [
        "125722.91",
        "0.005606"
      ],
      [
        "125722.96",
        "0.000188"
      ],
      [
        "125762.06",
        "0.00086"
      ],
      [
        "125813.26",
        "0.691039"
      ],
      [
        "125833.23",
        "0.000687"
      ],
      [
        "125846.37",
        "0.00076"
      ],
      [
        "125900.6",
        "0.000436"
      ],
      [
        "125965.5",
        "0.003294"
      ],
      [
        "125978.81",
        "0.0007"
      ],
      [
        "125981.59",
        "0.0012"
      ],
      [
        "126000",
        "0.000653"
      ],
      [
        "126077.2",
        "0.000304"
      ],
      [
        "126092.32",
        "0.691039"
      ],
      [
        "126205.13",
        "0.00087"
      ],
      [
        "126256.46",
        "0.00068"
      ],
      [
        "126300",
        "0.000214"
      ],
      [
        "126371.38",
        "0.691039"
      ],
      [
        "126378.32",
        "0.000051"
      ],
      [
        "126378.96",
        "0.005734"
      ],
      [
        "126420.92",
        "0.000937"
      ],
      [
        "126468.11",
        "0.007817"
      ],
      [
        "126549",
        "0.000143"
      ],
      [
        "126650.44",
        "0.511787"
      ],
      [
        "126662.53",
        "0.0012"
      ],
      [
        "126666.56",
        "0.000687"
      ],
      [
        "126783.5",
        "0.000304"
      ],
      [
        "126783.97",
        "0.00069"
      ],
      [
        "126862.79",
        "0.00094"
      ],
      [
        "126871.05",
        "0.002297"
      ],
      [
        "126929.5",
        "0.559809"
      ],
      [
        "126948.14",
        "0.000098"
      ],
      [
        "126948.21",
        "0.000131"
      ],
      [
        "126948.8",
        "0.000375"
      ],
      [
        "126957.15",
        "0.0008"
      ],
      [
        "126994.76",
        "0.00091"
      ],
      [
        "127000",
        "0.000482"
      ],
      [
        "127035.01",
        "0.005606"
      ],
      [
        "127116.79",
        "0.01532"
      ],
      [
        "127124.38",
        "0.000043"
      ],
      [
        "127157.76",
        "0.000796"
      ],
      [
        "127208.56",
        "0.483091"
      ],
      [
        "127247.91",
        "0.000181"
      ],
      [
        "127253.64",
        "0.000506"
      ],
      [
        "127309.32",
        "0.00086"
      ],
      [
        "127343.47",
        "0.0012"
      ],
      [
        "127367.38",
        "0.000128"
      ],
      [
        "127487.62",
        "0.152151"
      ],
      [
        "127488.89",
        "0.000436"
      ],
      [
        "127489.8",
        "0.000304"
      ],
      [
        "127499.89",
        "0.000687"
      ],
      [
        "127600",
        "0.000214"
      ],
      [
        "127643.75",
        "0.00066"
      ],
      [
        "127691.06",
        "0.005734"
      ],
      [
        "127695.95",
        "0.000143"
      ],
      [
        "127724.88",
        "0.00068"
      ],
      [
        "127766.68",
        "0.691039"
      ],
      [
        "127809.4",
        "0.000039"
      ],
      [
        "127825.32",
        "0.00093"
      ],
      [
        "127868.43",
        "0.001998"
      ],
      [
        "127894.6",
        "0.000937"
      ],
      [
        "127960.95",
        "0.00073"
      ],
      [
        "127970.66",
        "0.00088"
      ],
      [
        "128000",
        "0.000176"
      ],
      [
        "128015.13",
        "0.0008"
      ],
      [
        "128019.14",
        "0.000188"
      ],
      [
        "128024.41",
        "0.0012"
      ],
      [
        "128045.74",
        "0.691039"
      ],
      [
        "128110",
        "0.000096"
      ],
      [
        "128159.91",
        "0.00063"
      ],
      [
        "128196.1",
        "0.000304"
      ],
      [
        "128232.93",
        "0.00091"
      ],
      [
        "128257.29",
        "0.00067"
      ],
      [
        "128295.94",
        "0.000531"
      ],
      [
        "128324.8",
        "0.691039"
      ],
      [
        "128333.22",
        "0.000687"
      ],
      [
        "128342",
        "0.0008"
      ],
      [
        "128347.11",
        "0.005606"
      ],
      [
        "128429.94",
        "0.000049"
      ],
      [
        "128430",
        "0.00059"
      ],
      [
        "128463.28",
        "0.00081"
      ],
      [
        "128475.96",
        "0.00081"
      ],
      [
        "128500",
        "0.00094"
      ]
    ],
    "u": 403285,
    "seq": 1860999887
  },
  "cts": 1761592479020
}
```

Parameters to save:

- `ts`: number. The timestamp (ms) that the system generates the data.
- `data`: map. Object.
- `s`: string. Symbol name.
- `b`: array. Bids. For snapshot stream. Sorted by price in descending order
- `b[0]`: string. Bid price.
- `b[1]`: string. Bid size. The delta data has size=0, which means that all quotations for this price have been filled
  or cancelled.
- `a`: array Asks. For snapshot stream. Sorted by price in ascending order.
- `a[0]`: string. Ask price.
- `a[1]`: string. Ask size. The delta data has size=0, which means that all quotations for this price have been filled
  or cancelled.
- `u`: integer. Update ID. Occasionally, you'll receive "u"=1, which is a snapshot data due to the restart of the
  service. So please overwrite your local orderbook. For level 1 of linear, inverse Perps and Futures, the snapshot
  data will be pushed again when there is no change in 3 seconds, and the "u" will be the same as that in the previous
  message.
- `seq`: integer. Cross sequence. You can use this field to compare different levels orderbook data, and for the smaller
  seq, then it means the data is generated earlier.
- `cts`: number. The timestamp from the matching engine when this orderbook data is produced. It can be correlated with
  `T` from public trade channel.

The `order book` data must be saved in normalized form in the following table: `bybit_spot_order_book_200`.

- **Indexes**
    - Kliness: `(start_time DESC)`, `(symbol, start_time DESC)`.
    - Trades: `(trade_time DESC)`, `(symbol, trade_time DESC)`, `(cross_sequence)`.
    - Order book: `(engine_time DESC)`, `(symbol, engine_time DESC)`, `(symbol, side, price)`.

- **Compression, reorder, retention policies**
    - Compression enabled with `segmentby` on symbol (and side for order book). Compression window: 7 days.
    - Reorder by time-desc indexes for hot chunks.
    - Retention:
        - Klines: 15m→365d, 60m→730d, 240m→1095d, 1d→1825d.
        - Trades: 180d.
        - Order book L200: 7d.

- **Docs updated**
    - `README.md`: added new hypertables and migration note for `bybit_spot_tables.sql`.
    - `doc/0.0.1/collector-production-setup.md`: inventory and DB section updated; compose mount documented.

- **Notes**
    - Types: prices/volume/turnover stored as `NUMERIC(20,8)`; adjust as needed per symbol precision.
    - Ownership set to `crypto_scout_db`. Default privileges from `init.sql` continue to apply.